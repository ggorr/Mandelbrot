doctype
html(lang="ko-KR" dir="ltr")
	head
		meta(charset="utf-8")
		meta(name="viewport" content="width=device-width, initial-scale=1.0")
		link(rel="icon" href="mandel.ico")
		title Mandelbrot set
		link(rel="stylesheet" href="mandel.css")
		script(type="module").
			'use strict';
			import { setView, setXy, display, stopDisplay, downloadPng, downloadPng0 } from './js/mandel.js'
			import * as ui from './js/ui.js'

			document.getElementById('min-x').addEventListener('input', setView);
			document.getElementById('max-x').addEventListener('input', setView);
			document.getElementById('min-y').addEventListener('input', setView);
			document.getElementById('max-y').addEventListener('input', setView);
			document.getElementById('unit').addEventListener('input', setView);
			let radios = ['rgb0', 'rgb1', 'rgb2', 'hsv0', 'hsv1', 'hsv2', 'hsl0', 'hsl1', 'hsl2', 'rgb3', 'hsv3', 'hsl3'];
			radios.forEach(value => document.getElementById(value).addEventListener('click', () => display()));
			document.getElementById('unit').addEventListener('keydown', (e) => { if (e.keyCode == 13) display(); });
			let expands = {unit2:2, unit12:1/2, unit3:3, unit13:1/3, iter2:2, iter12:1/2, iter5:5, iter15:1/5};
			for (let id in expands) {
				document.getElementById(id).addEventListener('click', () => {
					let value = parseInt(document.getElementById(id.slice(0,4)).value);
					document.getElementById(id.slice(0,4)).value = expands[id] * value;
					display();
				});
			}
			document.getElementById('iter').addEventListener('keydown', (e) => { if (e.keyCode == 13) display(); });
			document.getElementById('display').addEventListener('click', display);
			document.getElementById('stop').addEventListener('click', stopDisplay);
			document.getElementById('download').addEventListener('click', (e) => downloadPng('none'));
			document.getElementById('filename').addEventListener('keydown', (e) => { if (e.keyCode == 13) downloadPng('none'); });
			document.getElementById('canvas').addEventListener('mousemove', e => setXy(e.offsetX, e.offsetY));
			document.getElementById('canvas').addEventListener("contextmenu", e => {
				e.preventDefault();
				ui.showContextmenu(e.pageX, e.pageY, e.offsetX, e.offsetY);
			});

			window.onload = () => {
				ui.createContextmenu();
				document.getElementById('rgb3').click();
			};
			window.onclick = ui.hideContextmenu;
	body
		div.left#left
			h2#title Mandelbrot set
			label.factor(for="min-x") x:
			| &nbsp;
			input.factor#min-x(value="-2.1" title='min x' required)
			| &nbsp;
			input.factor#max-x(value="1.1" title='max x' required)
			br
			label.factor(for="min-y") y:
			| &nbsp;
			input.factor#min-y(value="-1.5" title='min y' required)
			| &nbsp;
			input.factor#max-y(value="1.5" title='max y' required)
			br
			label.factor(for="unit") unit:
			| &nbsp;
			input.factor#unit(value="100" title='px' required)
			| &nbsp;
			button#unit2 &#x00D7;2
			button#unit12 /2
			button#unit3 &#x00D7;3
			button#unit13 /3
			br
			label.factor(for="iter") iter:
			| &nbsp;
			input.factor#iter(value="1000" required)
			| &nbsp;
			button#iter2 &#x00D7;2
			button#iter12 /2
			button#iter5 &#x00D7;5
			button#iter15 /5
			br
			div.container
				table
					each v, k in {'rgb':'RGB', 'hsv':'HSV', 'hsl':'HSL'}
						tr
							- for(var n = 0; n < 4; n++)
								td
									input.color-model(id=k + n type='radio' name='color-model')
									label.color-model(for=k + n)=v + n
									| &nbsp;
			div.container
				button#stop Stop
				| &nbsp;
				button#display Display
			span.info-left view:
			| &nbsp;
			span.info-right#view(title='(width, height) as px')
			br
			span.info-left (x, y):
			| &nbsp;
			span.info-right#xy
			br
			span.info-left time:
			| &nbsp;
			span.info-right#time
			br
			div.container
				label.invisible(for='filename') filename
				input#filename(value='noname.png')
				| &nbsp;
				button#download Download PNG
			//- div.container
			//- 	input#filename1(value='noname1.png')
			//- 	| &nbsp;
			//- 	button#download1 Download PNG 1
			//- div.container
			//- 	input#filename2(value='noname2.png')
			//- 	| &nbsp;
			//- 	button#download2 Download PNG 2 
			//- div.container
			//- 	input#filename3(value='noname3.png')
			//- 	| &nbsp;
			//- 	button#download3 Download PNG 3
			//- div.container
			//- 	input#filename4(value='noname4.png')
			//- 	| &nbsp;
			//- 	button#download4 Download PNG 4
			//- div.container
			//- 	input#filename5(value='noname5.png')
			//- 	| &nbsp;
			//- 	button#download5 Download PNG 5
			//- div.container
			//- 	input#filename0(value='noname0.png')
			//- 	| &nbsp;
			//- 	button#download0 Download PNG test
			div.container
				p by K. Park<br>ggorr.kp@gmail.com
		div.right#right
			canvas#canvas(title='right click for menu')
